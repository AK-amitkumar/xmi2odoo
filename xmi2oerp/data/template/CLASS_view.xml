<?xml version="1.0" encoding="utf-8"?>
<!--
${LICENSE_HEADER}\
-->
{% def model(s='.') %}${CLASS_MODULE}${s}${CLASS_NAME}{% end %}\
<openerp>
    <data>
{% if ('%s.%s' % (CLASS.package.name, CLASS.name) != CLASS.oerp_id('.')) %}
        <!-- INHERITED -->
{% end %}
{% if ('%s.%s' % (CLASS.package.name, CLASS.name) == CLASS.oerp_id('.')) %}
        <!-- SEARCHVIEW -->

        <!-- FORMVIEW -->

        <record id="view_${model('_')}_form" model="ir.ui.view">
            <field name="name">${model()}.form</field>
            <field name="model">${model()}</field>
            <field name="arch" type="xml">
                <form string="${CLASS_LABEL}" version="7.0">
                    <header>
{%                  for sm in CLASS.statemachines %}\
{%                    for t in [ t for t in set(sm.list_triggers()) ] %}\
                        <button name="sgn_${t.name}"
{%                          if 'class' in t.tag %}\
                            class="${t.tag['class']}"
{%                          end %}\
{%                          if 'type' in t.tag %}\
                            type="${t.tag['type']}"
{%                          end %}\
                            states="${','.join([ s.name for s in set(t.list_states_from(sm)) ])}"
                            string="${t.tag['label']}"
{%                          if 'groups' in t.tag %}\
                            groups="${t.tag['groups']}"
{%                          end %}\
                            />
{%                    end %}\
                        <field name="state" widget="statusbar" />
{%                  end %}\
                    </header>
                    <sheet string="${CLASS_LABEL}">
                     <group>
{%                  for col in CLASS.all_attributes(stereotype='form') %}\
                        <field name="${col.name}"/>
{%                  end %}\
{%                  for ass in CLASS.all_associations(stereotype='form') %}\
                        <field name="${ass.name}"/>
{%                  end %}\
                     </group>
                    </sheet>
{% if CLASS.is_child_of('mail.thread') %}
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
{% end %}
                </form>
            </field>
        </record>

        <!-- TREEVIEW -->

        <record id="view_${model('_')}_tree" model="ir.ui.view">
            <field name="name">${model()}.tree</field>
            <field name="model">${model()}</field>
            <field name="arch" type="xml">
                <tree string="${CLASS_LABEL}">
{%                  for col in CLASS.all_attributes(stereotype='tree') %}\
                    <field name="${col.name}"/>
{%                  end %}\
{%                  for ass in CLASS.all_associations(stereotype='tree') %}\
                    <field name="${ass.name}"/>
{%                  end %}\
                </tree>
            </field>
        </record>

        <!-- WINDOWACTION -->
        <record id="action_${model('_')}_form" model="ir.actions.act_window">
            <field name="name">${CLASS_LABEL}</field>
            <field name="res_model">${model()}</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
{%          if CLASS_DOCUMENTATION is not None %}\
            <field name="help">${CLASS_DOCUMENTATION}</field>
{%          end %}\
        </record>

        <!-- TREEWINDOWACTION -->

        <!-- FORMWINDOWACTION -->
{% end %}
    </data>
</openerp>
<!-- vim:expandtab:smartindent:tabstop=4:softtabstop=4:shiftwidth=4
     -->
